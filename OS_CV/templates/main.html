<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
    <title>OS-cv</title>
    <style>
      body {
        margin: 0;
        background: linear-gradient(135deg, #d7e1ec, #f3f3f3);
        font-family: sans-serif;
        overflow: hidden;
      }

      .inverted {
        clip-path: url(#clip);
        width: 100%;
        height: 100px;
        background-color: #b1b1b1;
        aspect-ratio: 4 / 1;
      }

      .row > * {
        flex-shrink: 0;
        width: 100%;
        max-width: 80%;
        padding-right: calc(var(--bs-gutter-x) * 0.5);
        padding-left: calc(var(--bs-gutter-x) * 0.5);
        margin-top: var(--bs-gutter-y);
      }

      .skill-box {
        clip-path: url(#clip-skill);
        width: 80px;
        height: 75px;
        background-color: var(--color);
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 15px;
        transition: transform 0.3s ease, filter 0.3s ease;
      }

      .skill-box img {
        width: 60%;
      }

      .skill-box:hover {
        transform: scale(1.1);
        filter: brightness(1.2);
        cursor: pointer;
      }

      .fixed-top-right {
        background: rgba(
          60,
          60,
          60,
          0.8
        ); /* Ø®Ø§Ú©Ø³ØªØ±ÛŒ ØªÛŒØ±Ù‡ Ø´ÙØ§Ùâ€ŒØªØ± Ø¨Ø±Ø§ÛŒ Ø­Ø³ Ù…Ø¯Ø±Ù† */
        color: white; /* Ø¨Ø±Ø§ÛŒ Ø¯ÛŒØ¯ Ø¨Ù‡ØªØ± Ù…ØªÙ† Ø±ÙˆÛŒ Ø²Ù…ÛŒÙ†Ù‡ */
        width: fit-content; /* Ø§Ù†Ø¯Ø§Ø²Ù‡ ÙÙ‚Ø· Ø¨Ù‡ Ø§Ù†Ø¯Ø§Ø²Ù‡ Ù…Ø­ØªÙˆØ§ */
        padding: 8px 15px; /* ÙØ§ØµÙ„Ù‡ Ø¯Ø§Ø®Ù„ÛŒ Ù…Ù†Ø§Ø³Ø¨ */
        display: flex;
        align-items: center;
        gap: 20px; /* ÙØ§ØµÙ„Ù‡ Ø¨ÛŒÙ† Ø³Ø§Ø¹ØªØŒ ØªØ§Ø±ÛŒØ®ØŒ Ø¨Ø§ØªØ±ÛŒ */
        border-radius: 12px;
        position: fixed;
        right: 15px;
        top: 10px;
        font-family: "Segoe UI", sans-serif;
        font-size: 14px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(6px); /* Ø§ÙÚ©Øª Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ Ø¬Ø°Ø§Ø¨ */
        z-index: 1000;
      }

      #battery-container {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-top: 5px;
      }

      #battery-outline {
        width: 40px;
        height: 20px;
        border: 2px solid #ddd;
        border-radius: 4px;
        position: relative;
        overflow: hidden;
      }

      #battery-cap {
        width: 4px;
        height: 10px;
        background: #ddd;
        border-radius: 2px;
        margin-left: -6px;
      }

      #battery-level {
        height: 100%;
        width: 50%;
        background: #4caf50;
        transition: width 0.5s ease, background 0.5s ease;
      }

      #battery-percentage {
        font-size: 0.9rem;
      }

      .app-window {
        position: absolute;
        top: 100px;
        left: 100px;
        width: 400px;
        background: #f3f3f3;
        border: 2px solid #444;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        z-index: 100;
        display: none;
      }

      .app-header {
        background: #555;
        color: white;
        padding: 8px;
        border-radius: 6px 6px 0 0;
        cursor: move;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .app-content {
        padding: 10px;
        color: #222;
      }

      .app-window {
        resize: both;
        overflow: auto;
      }

      #desktop-icons {
        display: flex;
        gap: 40px;
        flex-wrap: wrap;
        justify-content: center;
      }

      .app-icon {
        text-align: center;
        width: 80px;
        cursor: pointer;
      }

      .app-icon img {
        width: 64px;
        height: 64px;
        transition: 0.2s;
      }

      .app-icon:hover img {
        transform: scale(1.1);
      }

      .app-icon p {
        color: #333;
        font-size: 13px;
        margin-top: 4px;
      }

      /* Ù†Ø§Ø­ÛŒÙ‡ Ú©Ù„ÛŒ Ø¯Ø³Ú©ØªØ§Ù¾ */
      #desktop-area {
        position: relative;
        width: 100vw;
        height: 100vh;
        background: linear-gradient(180deg, #e8eaed, #cfd2d6);
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      /* Ø¨Ø®Ø´ Ø¢ÛŒÚ©ÙˆÙ†â€ŒÙ‡Ø§ Ø¯Ø± ÙˆØ³Ø· ØµÙØ­Ù‡ */
      #desktop-icons {
        display: flex;
        flex-wrap: wrap;
        justify-content: flex-start; /* Ø´Ø±ÙˆØ¹ Ø§Ø² Ø³Ù…Øª Ú†Ù¾ */
        align-items: center;
        gap: 25px;
        width: 70%;
        max-width: 800px;
        padding: 20px;
      }

      /* Ø¢ÛŒÚ©ÙˆÙ† Ù‡Ø± Ø§Ù¾Ù„ÛŒÚ©ÛŒØ´Ù† */
      .app-icon {
        width: 90px;
        height: 90px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 15px;
        backdrop-filter: blur(6px);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        transition: all 0.2s ease-in-out;
        text-align: center;
        user-select: none;
      }

      .app-icon img {
        width: 50px;
        height: 50px;
        object-fit: contain;
        margin-bottom: 8px;
      }

      .app-icon p {
        font-size: 14px;
        color: #2e2e2e;
        margin: 0;
        font-weight: 500;
      }
    </style>
  </head>
  <body>
    <!-- top part -->
    <div class="fixed-top-right">
      <div id="date-display"></div>
      <div id="time-display"></div>
      <div id="battery-container">
        <div id="battery-outline">
          <div id="battery-level"></div>
        </div>
        <div id="battery-cap"></div>
        <span id="battery-percentage"></span>
      </div>
    </div>

    <!-- Main part -->
    <div id="desktop-area">
      <div id="desktop-icons">
        {% for app in webApps %}
        <div
          class="app-icon"
          onclick="openApp('{{ app.name|slugify }}', '{{ app.name }}', `{{ app.html_content|safe }}`)"
        >
          <img src="{{ app.get_icon_url }}" alt="{{ app.name }}" />
          <p>{{ app.name }}</p>
        </div>
        {% endfor %}
      </div>
      <div id="window-container"></div>
    </div>
    <!-- bottom part -->
    <div class="row fixed-bottom justify-content-center">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        style="display: block; position: absolute"
        width="0"
        height="0"
      >
        <defs>
          <clipPath id="clip" clipPathUnits="objectBoundingBox">
            <path
              d="M0.065,0H0.935A0.065,0.26,0,0,1,1,0.26V0.74A0.065,0.26,0,0,1,0.935,1H0.065A0.065,0.26,0,0,1,0,0.74V0.26A0.065,0.26,0,0,1,0.065,0Z"
            />
          </clipPath>
        </defs>
      </svg>
      <div
        class="inverted d-flex flex-wrap justify-content-center align-items-center"
        style="border-radius: 60px"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          style="display: block; position: absolute"
          width="0"
          height="0"
        >
          <defs>
            <clipPath id="clip" clipPathUnits="objectBoundingBox">
              <path
                d="M0.195,0H0.805A0.195,0.195,0,0,1,1,0.195V0.805A0.195,0.195,0,0,1,0.805,1H0.195A0.195,0.195,0,0,1,0,0.805V0.195A0.195,0.195,0,0,1,0.195,0Z"
              />
            </clipPath>
          </defs>
        </svg>
        {% for skills in Skill %}
        <div
          class="skill-box"
          style="--color: {{ skills.color }}; clip-path: url(#clip);width: 80px;height: 75px;aspect-ratio: 1 / 1;border-radius: 20px;"
          data-bs-toggle="tooltip"
          title="{{ skills.title }}"
        >
          <img src="{{ skills.get_icon_url }}" alt="{{ skills.title }}" />
        </div>
        {% empty %}
        <p>there is no skills</p>
        {% endfor %}
      </div>
    </div>
  </body>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
    crossorigin="anonymous"
  ></script>
  <script>
    function updateClock() {
      const now = new Date();
      const time = now.toLocaleTimeString([], {
        hour: "2-digit",
        minute: "2-digit",
      });
      const date = now.toLocaleDateString(undefined, {
        weekday: "short",
        month: "short",
        day: "numeric",
      });
      document.getElementById("time-display").textContent = time;
      document.getElementById("date-display").textContent = date;
    }

    setInterval(updateClock, 1000);
    updateClock();

    if ("getBattery" in navigator) {
      navigator.getBattery().then(function (battery) {
        function updateBattery() {
          const level = Math.round(battery.level * 100);
          document.getElementById(
            "battery-display"
          ).textContent = `ğŸ”‹${level}%`;
        }
        updateBattery();
        battery.addEventListener("levelchange", updateBattery);
      });
    } else {
      document.getElementById("battery-display").textContent = "ğŸ”‹N/A";
    }

    async function updateBattery() {
      if ("getBattery" in navigator) {
        const battery = await navigator.getBattery();
        const levelBar = document.getElementById("battery-level");
        const percentageText = document.getElementById("battery-percentage");

        function updateAll() {
          const level = Math.round(battery.level * 100);
          percentageText.textContent = level + "%";
          levelBar.style.width = level + "%";

          if (battery.charging) {
            levelBar.style.background = "#00bcd4"; // Ø¢Ø¨ÛŒ Ø¯Ø± Ø­Ø§Ù„Øª Ø´Ø§Ø±Ú˜
          } else if (level > 80) {
            levelBar.style.background = "#4caf50"; // Ø³Ø¨Ø²
          } else if (level > 40) {
            levelBar.style.background = "#ffeb3b"; // Ø²Ø±Ø¯
          } else if (level > 15) {
            levelBar.style.background = "#ff9800"; // Ù†Ø§Ø±Ù†Ø¬ÛŒ
          } else {
            levelBar.style.background = "#f44336"; // Ù‚Ø±Ù…Ø²
          }
        }

        updateAll();
        battery.addEventListener("levelchange", updateAll);
        battery.addEventListener("chargingchange", updateAll);
      } else {
        document.getElementById("battery-container").innerHTML =
          "Battery info not supported";
      }
    }

    updateBattery();

    function openApp(appId, appName, htmlContent, cssContent, jsContent) {
      // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ù‚Ø¨Ù„Ø§Ù‹ Ø¨Ø§Ø² Ø´Ø¯Ù‡ ÛŒØ§ Ù†Ù‡
      let existing = document.getElementById("window-" + appId);
      if (existing) {
        existing.style.display = "block";
        return;
      }

      // Ø³Ø§Ø®Øª Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯
      const windowEl = document.createElement("div");
      windowEl.classList.add("app-window");
      windowEl.id = "window-" + appId;
      windowEl.innerHTML = `
    <div class="app-header">
      <span>${appName}</span>
      <button onclick="this.closest('.app-window').remove()">Ã—</button>
    </div>
    <div class="app-body">${htmlContent}</div>
  `;

      document.getElementById("window-container").appendChild(windowEl);

      // CSS Ø§Ø®ØªØµØ§ØµÛŒ
      if (cssContent) {
        const styleTag = document.createElement("style");
        styleTag.textContent = cssContent;
        document.head.appendChild(styleTag);
      }

      // JS Ø§Ø®ØªØµØ§ØµÛŒ
      if (jsContent) {
        const scriptTag = document.createElement("script");
        scriptTag.textContent = jsContent;
        document.body.appendChild(scriptTag);
      }

      makeDraggable(windowEl);
    }

    function makeDraggable(el) {
      const header = el.querySelector(".app-header");
      let offsetX,
        offsetY,
        isDown = false;

      header.addEventListener("mousedown", (e) => {
        isDown = true;
        offsetX = e.clientX - el.offsetLeft;
        offsetY = e.clientY - el.offsetTop;
        header.style.cursor = "grabbing";
      });

      document.addEventListener("mouseup", () => {
        isDown = false;
        header.style.cursor = "grab";
      });

      document.addEventListener("mousemove", (e) => {
        if (!isDown) return;
        el.style.left = `${e.clientX - offsetX}px`;
        el.style.top = `${e.clientY - offsetY}px`;
      });
    }
  </script>
</html>
